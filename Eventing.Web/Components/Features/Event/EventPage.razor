@page "/events"
@using Eventing.Web.Components.Features.Event.Enums
@using Eventing.Web.Components.Toolbars

<PageTitle>Events</PageTitle>

@if (IsLoading)
{
    <MudProgressLinear Indeterminate="true" Color="Color.Primary"/>
}
else
{
    <MudContainer>
        <Toolbar/>
        <MudGrid>
            @foreach (var e in Events)
            {
                <MudItem xs="12" sm="6" md="4" lg="3" xl="2">
                    <MudCard Class="rounded-2xl shadow-md hover:shadow-lg transition-shadow duration-300">
                        <!-- Top Header -->
                        <MudCardHeader Class="pb-0">
                            <CardHeaderContent>
                                <MudText Typo="Typo.h6" Class="font-semibold">@e.Title</MudText>
                            </CardHeaderContent>
                            <CardHeaderActions>
                                <MudTooltip Text="Attendees">
                                    <MudIconButton OnClick="@(() => OpenAttendeesDialogAsync(e.Id))"
                                                   Icon="@Icons.Material.Filled.People" Color="Color.Primary"
                                                   Size="Size.Medium"/>
                                </MudTooltip>
                            </CardHeaderActions>
                        </MudCardHeader>

                        <!-- Content -->
                        <MudCardContent Class="pt-2">
                            <MudText Typo="Typo.body2" Class="text-gray-700">@e.Description</MudText>

                            <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="2" Class="mt-2">
                                <MudIcon Icon="@Icons.Material.Filled.Event" Color="Color.Primary"
                                         Size="Size.Small"/>
                                <MudText Typo="Typo.caption">
                                    @if (e.StartTime.Date == e.EndTime.Date)
                                    {
                                        @e.StartTime.ToString(Constants.Format.DateTime.MonthDayYearHourMinute)
                                        @(" - ")
                                        @e.EndTime.ToString(Constants.Format.DateTime.HourMinute12)
                                    }
                                    else
                                    {
                                        @e.StartTime.ToString(Constants.Format.DateTime.MonthDayYearHourMinute)
                                        @(" - ")
                                        @e.EndTime.ToString(Constants.Format.DateTime.MonthDayYearHourMinute)
                                    }
                                </MudText>
                            </MudStack>

                            @if (e.LocationType == LocationType.Physical)
                            {
                                <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="2" Class="mt-1">
                                    <MudIcon Icon="@Icons.Material.Filled.LocationOn" Color="Color.Primary"
                                             Size="Size.Small"/>
                                    <MudText Typo="Typo.caption">@e.Location</MudText>
                                </MudStack>
                            }
                            else
                            {
                                <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="2" Class="mt-1">
                                    <MudIcon Icon="@Icons.Material.Filled.Link" Color="Color.Primary"
                                             Size="Size.Small"/>
                                    <MudLink Href="@e.Location" Target="_blank" Typo="Typo.caption"
                                             Class="overflow-auto">@e.Location</MudLink>
                                </MudStack>
                            }
                        </MudCardContent>
                        <MudDivider Class="border-dashed"/>
                        <MudCardHeader>
                            <CardHeaderAvatar>
                                <MudAvatar Size="Size.Medium" Color="Color.Primary" Class="shadow-sm">
                                    @Utils.GetInitials(e.CreatedBy.Name)
                                </MudAvatar>
                            </CardHeaderAvatar>
                            <CardHeaderContent>
                                <MudText Typo="Typo.body1" Class="font-medium">@e.CreatedBy.Name</MudText>
                                <MudText Typo="Typo.caption"
                                         Class="text-gray-500">@e.CreatedAt.ToString(Constants.Format.DateTime.MonthDayYear)</MudText>
                            </CardHeaderContent>
                            <CardHeaderActions>
                            </CardHeaderActions>
                        </MudCardHeader>
                    </MudCard>
                </MudItem>
            }
        </MudGrid>

        <MudScrollToTop>
            <MudFab Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.ArrowUpward"
                    Color="Color.Primary"/>
        </MudScrollToTop>
    </MudContainer>
}